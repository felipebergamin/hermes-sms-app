function controller(a,r,o){a.loadUsers=function(){o.getAll().then(function(r){a.users=r.data},function(a){r.error(a.message,"Erro ao obter a lista de usuários do servidor!")})},a.newForm=function(){a.form={function:"create",user:{name:"",email:"",password:"",password_confirm:"",habilitado:1,permissoes:{enviar_sms:!0,enviar_lote_sms:!1,manter_usuarios:!1,visualizar_envios:!1,visualizar_relatorios:!1}}}},a.init=function(){a.loadUsers(),a.newForm()},a.disableUser=function(a){a.habilitado=!1,o.update(a).then(function(a){r.success("Usuário "+a.data.name+" desabilitado!")},function(a){422===a.status?r.showValidationErrors(a.data):r.error(a.data.message,"Erro ao desabilitar o usuário!")})},a.enableUser=function(a){a.habilitado=!0,o.update(a).then(function(a){r.success("Usuário "+a.data.name+" habilitado!")},function(o){a.habilitado=!1,422===o.status?r.showValidationErrors(o.data):r.error(o.data.message,"Ops! Ocorreu um erro!")})},a.editUser=function(r,o){a.form.function="update",a.form.user=angular.copy(a.users[o]),a.form.indexInCollection=o},a.formSubmit=function(){"create"===a.form.function?(a.form.user.habilitado=!0,o.store(a.form.user).then(function(o){a.newForm(),a.users.push(o.data),r.success("Usuário "+o.data.name+" cadastrado!")},function(a){422===a.status?r.showValidationErrors(a.data):r.error(a.data.message,"Falha ao cadastrar usuário!")})):"update"===a.form.function&&o.update(a.form.user).then(function(o){a.newForm(),r.success("Usuário "+o.data.name+" atualizado!");for(var s=0;s<a.users.length;s++)if(a.users[s].id===o.data.id){a.users[s]=angular.copy(o.data);break}},function(a){422===a.status?r.showValidationErrors(a.data):r.error(a.data.message,"Houve um erro desconhecido!")})}}angular.module("hermes_app").controller("users_ctrl",["$scope","notify","usersAPI",controller]);